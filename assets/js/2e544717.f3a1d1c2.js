(self.webpackChunkdocs=self.webpackChunkdocs||[]).push([[518],{5054:function(e,t,n){"use strict";n.r(t),n.d(t,{frontMatter:function(){return o},metadata:function(){return l},toc:function(){return s},default:function(){return d}});var i=n(2122),a=n(9756),r=(n(7294),n(3905)),o={title:"Rules of use-fixed"},l={unversionedId:"rules",id:"rules",isDocsHomePage:!1,title:"Rules of use-fixed",description:"As much as we hate to have rules, the library does have a limitation. To overcome this, we have added the following set of rules. The rules are kept to a minimum here. With time, they will feel embedded.",source:"@site/docs/rules.md",sourceDirName:".",slug:"/rules",permalink:"/use-fixed/docs/rules",editUrl:"https://github.com/paulKabira/use-fixed/edit/master/docs/docs/rules.md",version:"current",frontMatter:{title:"Rules of use-fixed"},sidebar:"docs",previous:{title:"Implementation",permalink:"/use-fixed/docs/implementation"}},s=[{value:"Rule 1: Use <code>.n()</code> in <code>render</code> phases",id:"rule-1-use-n-in-render-phases",children:[]},{value:"Rule 2: Execute directly in <code>commit</code> phases",id:"rule-2-execute-directly-in-commit-phases",children:[]}],u={toc:s};function d(e){var t=e.components,n=(0,a.Z)(e,["components"]);return(0,r.kt)("wrapper",(0,i.Z)({},u,n,{components:t,mdxType:"MDXLayout"}),(0,r.kt)("p",null,"As much as we hate to have rules, the library does have a limitation. To overcome this, we have added the following set of rules. The rules are kept to a minimum here. With time, they will feel embedded."),(0,r.kt)("p",null,"The ",(0,r.kt)("inlineCode",{parentName:"p"},"FixedCallback")," and ",(0,r.kt)("inlineCode",{parentName:"p"},"FixedGetter"),", both are ",(0,r.kt)("inlineCode",{parentName:"p"},"Function"),"s. Both have one extra key called ",(0,r.kt)("inlineCode",{parentName:"p"},"n"),", which is also a function. Both will return the same results, but can return different versions of the same result. This is because to react runs in 2 phases, the ",(0,r.kt)("inlineCode",{parentName:"p"},"render")," phase and the ",(0,r.kt)("inlineCode",{parentName:"p"},"commit")," phase. With ",(0,r.kt)("a",{parentName:"p",href:"https://reactjs.org/docs/concurrent-mode-intro.html"},"concurrent-mode")," completing development, this can mean that the ",(0,r.kt)("inlineCode",{parentName:"p"},"render")," phases get multiple time without ever committing any dom changes. To maintain parity with this, we store 2 copies of the same data, one for ",(0,r.kt)("strong",{parentName:"p"},"render")," phase (",(0,r.kt)("inlineCode",{parentName:"p"},"FixedCallback.n()")," or ",(0,r.kt)("inlineCode",{parentName:"p"},"FixedGetter.n()"),") and one for ",(0,r.kt)("strong",{parentName:"p"},"commit")," phase (",(0,r.kt)("inlineCode",{parentName:"p"},"FixedCallback()")," or ",(0,r.kt)("inlineCode",{parentName:"p"},"FixedGetter"),")."),(0,r.kt)("p",null,"Assuming that you have the following"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-tsx"},"const greet = useFixedCallback((name=null) => `Hello ${name || stateVar}`)\n")),(0,r.kt)("h3",{id:"rule-1-use-n-in-render-phases"},"Rule 1: Use ",(0,r.kt)("inlineCode",{parentName:"h3"},".n()")," in ",(0,r.kt)("inlineCode",{parentName:"h3"},"render")," phases"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"in ",(0,r.kt)("inlineCode",{parentName:"li"},"useMemo(() => greet.n(), [])")),(0,r.kt)("li",{parentName:"ul"},"in useState when initializing with a function ",(0,r.kt)("inlineCode",{parentName:"li"},"useState(() => greet.n())")),(0,r.kt)("li",{parentName:"ul"},"in body of the functional component ",(0,r.kt)("inlineCode",{parentName:"li"},"return <span>greet.n('Paul')</span>;"))),(0,r.kt)("h3",{id:"rule-2-execute-directly-in-commit-phases"},"Rule 2: Execute directly in ",(0,r.kt)("inlineCode",{parentName:"h3"},"commit")," phases"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"in ",(0,r.kt)("inlineCode",{parentName:"li"},"useEffect(() => greet(), []);")),(0,r.kt)("li",{parentName:"ul"},"in ",(0,r.kt)("inlineCode",{parentName:"li"},"useLayoutEffect(() => greet(), []);"))))}d.isMDXComponent=!0}}]);